
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../fullgame/">
      
      
        <link rel="next" href="../tensor_agent/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>Mini-Game - Civrealm</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mini-game" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Civrealm" class="md-header__button md-logo" aria-label="Civrealm" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Civrealm
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mini-Game
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/civrealm/civrealm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81-2.9-.295-5.7.083-8.4 1.11-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.09 18.09 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3 4.7 0 9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82z"/></svg>
  </div>
  <div class="md-source__repository">
    civilization/civrealm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../game_setting/" class="md-tabs__link">
          
  
    
  
  Advanced Materials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../api_reference/api/" class="md-tabs__link">
        
  
    
  
  Api Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../releases/releases/" class="md-tabs__link">
        
  
    
  
  Releases

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../notes/contribute/" class="md-tabs__link">
          
  
    
  
  Notes

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../misc/faq/" class="md-tabs__link">
          
  
    
  
  Misc

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Civrealm" class="md-nav__button md-logo" aria-label="Civrealm" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Civrealm
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/civrealm/civrealm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81-2.9-.295-5.7.083-8.4 1.11-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.09 18.09 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3 4.7 0 9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82z"/></svg>
  </div>
  <div class="md-source__repository">
    civilization/civrealm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Advanced Materials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Advanced Materials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Game
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Game
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../game_setting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game Setting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fullgame/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full Game
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Mini-Game
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Mini-Game
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting" class="md-nav__link">
    üéÆ Setting
  </a>
  
    <nav class="md-nav" aria-label="üéÆ Setting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#game-status" class="md-nav__link">
    üèÅ Game Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-difficulty" class="md-nav__link">
    üî• Game Difficulty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#victory-status" class="md-nav__link">
    üèÜ Victory Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-types" class="md-nav__link">
    üó∫Ô∏è Supported Types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-dataset" class="md-nav__link">
    Prepare Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialize-random-mini-game" class="md-nav__link">
    Initialize Random Mini-Game
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choose-specific-mini-game" class="md-nav__link">
    Choose Specific Mini-Game
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definition-of-mini-game-messages" class="md-nav__link">
    Definition of Mini-game messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#play-mini-game-as-a-random-agent" class="md-nav__link">
    Play mini-game as a random agent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-new-mini-game" class="md-nav__link">
    Create new Mini-Game
  </a>
  
    <nav class="md-nav" aria-label="Create new Mini-Game">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#be-clear-about-what-to-do" class="md-nav__link">
    Be clear about what to do
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-gtk-tool-to-generate-basic-archive" class="md-nav__link">
    Use gtk tool to generate basic archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-mini-game-messages-by-lua-script" class="md-nav__link">
    Set mini-game messages by lua script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#large-batch-auto-random-generation" class="md-nav__link">
    Large batch auto random generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mini-game-validation" class="md-nav__link">
    Mini-Game Validation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Agent
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tensor_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensor Agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../llm_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLM Agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Train Scheme
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Train Scheme
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../parallel_training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel Training
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../api_reference/api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Api Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/releases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notes/contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute To CivRealm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../notes/benchmarks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance Benchmarks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting" class="md-nav__link">
    üéÆ Setting
  </a>
  
    <nav class="md-nav" aria-label="üéÆ Setting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#game-status" class="md-nav__link">
    üèÅ Game Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-difficulty" class="md-nav__link">
    üî• Game Difficulty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#victory-status" class="md-nav__link">
    üèÜ Victory Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-types" class="md-nav__link">
    üó∫Ô∏è Supported Types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-dataset" class="md-nav__link">
    Prepare Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialize-random-mini-game" class="md-nav__link">
    Initialize Random Mini-Game
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choose-specific-mini-game" class="md-nav__link">
    Choose Specific Mini-Game
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definition-of-mini-game-messages" class="md-nav__link">
    Definition of Mini-game messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#play-mini-game-as-a-random-agent" class="md-nav__link">
    Play mini-game as a random agent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-new-mini-game" class="md-nav__link">
    Create new Mini-Game
  </a>
  
    <nav class="md-nav" aria-label="Create new Mini-Game">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#be-clear-about-what-to-do" class="md-nav__link">
    Be clear about what to do
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-gtk-tool-to-generate-basic-archive" class="md-nav__link">
    Use gtk tool to generate basic archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-mini-game-messages-by-lua-script" class="md-nav__link">
    Set mini-game messages by lua script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#large-batch-auto-random-generation" class="md-nav__link">
    Large batch auto random generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mini-game-validation" class="md-nav__link">
    Mini-Game Validation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="mini-game">Mini-Game</h1>
<p>Due to the multifaceted aspects of a full game, including economic expansion, military development, diplomatic negotiations, cultural construction, and technological research, we have devised mini games to address each component individually. Each mini-game is designed with specific objectives, varying difficulty levels, step-based rewards, and an overall game score. The designed details could be found in the <a href="https://openreview.net/forum?id=UBVNwD3hPN">paper</a>.</p>
<p>By the end of this tutorial, you will be able to</p>
<ul>
<li>Understand the basic setting of mini-game</li>
<li>Initialize mini-game by using API for random initialization or manual specification</li>
<li>Create a new mini-game by yourself</li>
</ul>
<h2 id="setting">üéÆ Setting</h2>
<h3 id="game-status">üèÅ Game Status</h3>
<p>To describe whether a mini-game is over, the game-ending conditions include:</p>
<ul>
<li>The game score being greater than or equal to the goal score</li>
<li>Reaching the maximum number of rounds set for the game</li>
</ul>
<p>The enumerated values are as follows:
<div class="language-python highlight"><span class="filename">src/civrealm/envs/freeciv_minitask_env.py</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@unique</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">class</span> <span class="nc">MinitaskGameStatus</span><span class="p">(</span><span class="n">ExtendedEnum</span><span class="p">):</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">MGS_END_GAME</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">MGS_IN_GAME</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div></p>
<h3 id="game-difficulty">üî• Game Difficulty</h3>
<p>Based on the richness of terrain resources, the comparison of unit quantities, and other information, we designed the difficulty level of the mini-game.</p>
<p>The enumerated values are as follows:
<div class="language-python highlight"><span class="filename">src/civrealm/envs/freeciv_minitask_env.py</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nd">@unique</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">class</span> <span class="nc">MinitaskDifficulty</span><span class="p">(</span><span class="n">ExtendedEnum</span><span class="p">):</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">MD_EASY</span> <span class="o">=</span> <span class="s1">&#39;easy&#39;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="n">MD_NORMAL</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">MD_HARD</span> <span class="o">=</span> <span class="s1">&#39;hard&#39;</span>
</span></code></pre></div></p>
<h3 id="victory-status">üèÜ Victory Status</h3>
<p>In the mini-game, the player‚Äôs current victory status can be represented as: failure, success, and unknown. The unknown state signifies that the game has not yet concluded, while the determination of failure and success only occurs after the game ends.</p>
<p>The enumerated values are as follows:
<div class="language-python highlight"><span class="filename">src/civrealm/envs/freeciv_minitask_env.py</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nd">@unique</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">class</span> <span class="nc">MinitaskPlayerStatus</span><span class="p">(</span><span class="n">ExtendedEnum</span><span class="p">):</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">MPS_SUCCESS</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">MPS_FAIL</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">MPS_UNKNOWN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></code></pre></div></p>
<h3 id="supported-types">üó∫Ô∏è Supported Types</h3>
<p>We have designed the following 10 types of mini-games:</p>
<table>
    <tr> 
        <td bgcolor="Lavender"><b>Category</b></td>
        <td bgcolor="Lavender"><b>ID</b></td>
        <td bgcolor="Lavender"><b>Name</b></td>
        <td bgcolor="Lavender"><b>Introduction</b></td>
    </tr>
    <tr> 
        <td rowspan="4">Development</td>
        <td>1</td>
        <td>development_build_city</td>
        <td>Move settler to suitable areas for building a city.</td>
    </tr>
    <tr> 
        <td>2</td>
        <td>development_build_infra</td>
        <td>Command workers to build infrastructures for improving cities.</td>
    </tr>
    <tr> 
        <td>3</td>
        <td>development_citytile_wonder</td>
        <td>Arrange work tiles to speed up producing a world wonder.</td>
    </tr>
    <tr> 
        <td>4</td>
        <td>development_transport</td>
        <td>Transport settlers by ships to another continent and build cities.</td>
    </tr>
    <tr> 
        <td rowspan="5">Battle</td>
        <td>5</td>
        <td>battle_[ancient_era,industry_era,<br>info_era,medieval,modern_era]</td>
        <td>Defeat enemy units on land tiles (units from various ages).</td>
    </tr>
    <tr> 
        <td>6</td>
        <td>battle_attack_city</td>
        <td>Conquer an enemy city.</td>
    </tr>
    <tr> 
        <td>7</td>
        <td>battle_defend_city</td>
        <td>Against enemy invasion for a certain number of turns.</td>
    </tr>
    <tr> 
        <td>8</td>
        <td>battle_naval</td>
        <td>Defeat enemy fleet on the ocean (with Middle Times frigates).</td>
    </tr>
    <tr> 
        <td>9</td>
        <td>battle_naval_modern</td>
        <td>Defeat enemy fleet on the ocean (with several classes of modern ships).</td>
    </tr>
    <tr> 
        <td>Diplomacy</td>
        <td>10</td>
        <td>diplomacy_trade_tech</td>
        <td>Trade technologies with another civilization.</td>
    </tr>

</table>

<p>The enumerated values are as follows:
<div class="language-python highlight"><span class="filename">src/civrealm/envs/freeciv_minitask_env.py</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nd">@unique</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">class</span> <span class="nc">MinitaskType</span><span class="p">(</span><span class="n">ExtendedEnum</span><span class="p">):</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">MT_DEVELOPMENT_BUILD_CITY</span> <span class="o">=</span> <span class="s2">&quot;development_build_city&quot;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">MT_DEVELOPMENT_CITYTILE_WONDER</span> <span class="o">=</span> <span class="s2">&quot;development_citytile_wonder&quot;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">MT_DEVELOPMENT_BUILD_INFRA</span> <span class="o">=</span> <span class="s2">&quot;development_build_infra&quot;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">MT_DEVELOPMENT_TRANSPORT</span> <span class="o">=</span> <span class="s2">&quot;development_transport&quot;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">MT_BATTLE_ANCIENT</span> <span class="o">=</span> <span class="s2">&quot;battle_ancient_era&quot;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">MT_BATTLE_INDUSTRY</span> <span class="o">=</span> <span class="s2">&quot;battle_industry_era&quot;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">MT_BATTLE_INFO</span> <span class="o">=</span> <span class="s2">&quot;battle_info_era&quot;</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">MT_BATTLE_MEDIEVAL</span> <span class="o">=</span> <span class="s2">&quot;battle_medieval&quot;</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">MT_BATTLE_MODERN</span> <span class="o">=</span> <span class="s2">&quot;battle_modern_era&quot;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="n">MT_BATTLE_NAVAL_MODERN</span> <span class="o">=</span> <span class="s2">&quot;battle_naval_modern&quot;</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="n">MT_BATTLE_NAVAL</span> <span class="o">=</span> <span class="s2">&quot;battle_naval&quot;</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    <span class="n">MT_BATTLE_ATTACK_CITY</span> <span class="o">=</span> <span class="s2">&quot;battle_attack_city&quot;</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="n">MT_BATTLE_DEFEND_CITY</span> <span class="o">=</span> <span class="s2">&quot;battle_defend_city&quot;</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    <span class="n">MT_DIPLOMACY_TRADE_TECH</span> <span class="o">=</span> <span class="s2">&quot;diplomacy_trade_tech&quot;</span>
</span></code></pre></div></p>
<h2 id="prepare-dataset">Prepare Dataset</h2>
<p><b>Before you start the mini-game</b>, you need to load the mini-game designed archives into the server‚Äôs laoding archive path.</p>
<p>The steps are as follows:</p>
<p><b>Step 1: </b> find your used version on the releases page, and download the data files for the mini-game to your local path such as <code>/tmp/minigame/</code></p>
<p><b>Step 2: </b> copy the data files, and extract them into the corresponding docker savegame path. If the docker image is <code>freeciv-web</code>, and the tomcat version is <code>10</code>, then execute the following commands:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nv">image</span><span class="o">=</span><span class="s2">&quot;freeciv-web&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nv">tomcat_version</span><span class="o">=</span><span class="s2">&quot;tomcat10&quot;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nv">local_path</span><span class="o">=</span><span class="s2">&quot;/tmp/minigame/&quot;</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>mkdir<span class="w"> </span><span class="nv">$local_path</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$local_path</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span><span class="nv">$image</span><span class="w"> </span>rm<span class="w"> </span>-r<span class="w"> </span>/var/lib/<span class="nv">$tomcat_version</span>/webapps/data/savegames/minitask/
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span><span class="nv">$image</span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/lib/<span class="nv">$tomcat_version</span>/webapps/data/savegames/minitask/
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="k">for</span><span class="w"> </span>minitask_zip<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>ls<span class="sb">`</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="k">do</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span>docker<span class="w"> </span>cp<span class="w"> </span><span class="nv">$minitask_zip</span><span class="w"> </span><span class="nv">$image</span>:/var/lib/<span class="nv">$tomcat_version</span>/webapps/data/savegames/minitask/
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span><span class="nv">$image</span><span class="w"> </span>unzip<span class="w"> </span>-o<span class="w"> </span>/var/lib/<span class="nv">$tomcat_version</span>/webapps/data/savegames/minitask/<span class="nv">$minitask_zip</span><span class="w"> </span>-d<span class="w"> </span>/var/lib/<span class="nv">$tomcat_version</span>/webapps/data/savegames/minitask/
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span><span class="nv">$image</span><span class="w"> </span>rm<span class="w"> </span>/var/lib/<span class="nv">$tomcat_version</span>/webapps/data/savegames/minitask/<span class="nv">$minitask_zip</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="k">done</span>
</span></code></pre></div></p>
<h2 id="initialize-random-mini-game">Initialize Random Mini-Game</h2>
<p><code>freeciv/FreecivMinitask-v0</code> is the environment of mini-game. When the mini game is launched, its internal design will randomly select a game of any type and any difficulty.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">civrealm.agents</span> <span class="kn">import</span> <span class="n">ControllerAgent</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">import</span> <span class="nn">gymnasium</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">env</span> <span class="o">=</span> <span class="n">gymnasium</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;freeciv/FreecivMinitask-v0&#39;</span><span class="p">)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">ControllerAgent</span><span class="p">()</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">observations</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></code></pre></div>
<h2 id="choose-specific-mini-game">Choose Specific Mini-Game</h2>
<p>Inside <code>reset</code> method of environment, you can use the parameter <code>minitask_pattern</code> to choose specific mini-game. The fields are as follows:</p>
<p><code>type</code>: the type of mini-game, see the available options MinitaskType</p>
<p><code>level</code>: the difficulty of mini-game, see the available options MinitaskDifficulty</p>
<p><code>id</code>: the id of mini-game, the available range is 0 to MAX_ID</p>
<p>For example, if you want to set the type as <code>development_build_city</code> and the difficulty as <code>easy</code>, then the code is as follows:
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">civrealm.agents</span> <span class="kn">import</span> <span class="n">ControllerAgent</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">import</span> <span class="nn">gymnasium</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">env</span> <span class="o">=</span> <span class="n">gymnasium</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;freeciv/FreecivMinitask-v0&quot;</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">observations</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">minitask_pattern</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;development_build_city&quot;</span><span class="p">,</span> 
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;easy&quot;</span><span class="p">})</span>
</span></code></pre></div></p>
<h2 id="definition-of-mini-game-messages">Definition of Mini-game messages</h2>
<p>The messages of mini-game are passed from the server to the agent at each trigger point by lua script setting. The general json structure of message is:
<div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;minitask&quot;</span><span class="p">,</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${name of minitask}&quot;</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="err">Mi</span><span class="kc">n</span><span class="err">i</span><span class="kc">tas</span><span class="err">kGameS</span><span class="kc">tatus</span><span class="p">},</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="nt">&quot;turn&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="kc">turn</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="err">game</span><span class="p">},</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="nt">&quot;metrics&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">        </span><span class="nt">&quot;mini_score&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="err">mi</span><span class="kc">n</span><span class="err">i_score</span><span class="p">},</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">        </span><span class="nt">&quot;mini_goal&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="err">mi</span><span class="kc">n</span><span class="err">i_goal</span><span class="p">},</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="nt">&quot;max_turn&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="err">max_</span><span class="kc">turn</span><span class="p">},</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="nt">&quot;is_mini_success&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="err">Mi</span><span class="kc">n</span><span class="err">i</span><span class="kc">tas</span><span class="err">kPlayerS</span><span class="kc">tatus</span><span class="p">},</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="p">}]</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="p">}</span>
</span></code></pre></div></p>
<ul>
<li>
<p>The <code>task</code> is used to label the source of message. The <code>task</code> for messages from mini-game is set to be <code>minitask</code>.</p>
</li>
<li>
<p>The final element of <code>metrics</code> records the final game review status for each trigger action, which is actually used in civrealm. In the dict structure of <code>metrics</code> elements, we can  define other useful auxiliary information</p>
</li>
<li>
<p>The <code>metrics.mini_score</code> is used to record the agent's mini-game score.</p>
</li>
<li>
<p>The <code>metrics.mini_goal</code> is used to record the agent's mini-game goal, which is to set the game victory score threshold.</p>
</li>
<li>
<p>The <code>metrics.max_turn</code> is limited to a certain number of turns. If the maximum number of turns is exceeded, failure is returned in civrealm.</p>
</li>
<li>
<p>The <code>metrics.is_mini_success</code> is used to record the player succeed status of player, which is the same as <code>success</code> defined of minitask info in civrealm. If succeed, it requires that <code>mini_score&gt;=mini_goal</code>.</p>
</li>
</ul>
<h2 id="play-mini-game-as-a-random-agent">Play mini-game as a random agent</h2>
<p>Generally speaking, it is difficult for random agents to win the battle and diplomacy mini-game, and in the development mini-game, the game victory condition will be met with a certain probability.</p>
<p>The commands are as follows:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span>civrealm/
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>python<span class="w"> </span>src/civrealm/random_game_minitask.py
</span></code></pre></div></p>
<p>After executing the commands, the log will be like:
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Step: 0, Turn: 1, Reward: 0.0, Terminated: False, Truncated: False, Action: (&#39;tech&#39;, &#39;cur_player&#39;, &#39;set_tech_goal_Conscription_18&#39;)
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>        Minitask Info: {&#39;status&#39;: 0, &#39;success&#39;: -1, &#39;human_cnt&#39;: 11.0, &#39;ai_cnt&#39;: 12.0, &#39;mini_score&#39;: -1.0, &#39;mini_goal&#39;: 11.0, &#39;max_turn&#39;: 50, &#39;human_leader_alive&#39;: 1, &#39;ai_leader_alive&#39;: 1, &#39;is_mini_success&#39;: -1}
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Step: 1, Turn: 1, Reward: 0.0, Terminated: False, Truncated: False, Action: (&#39;unit&#39;, 108, &#39;goto_1&#39;)
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        Minitask Info: {&#39;status&#39;: 0, &#39;success&#39;: -1, &#39;human_cnt&#39;: 11.0, &#39;ai_cnt&#39;: 12.0, &#39;mini_score&#39;: -1.0, &#39;mini_goal&#39;: 11.0, &#39;max_turn&#39;: 50, &#39;human_leader_alive&#39;: 1, &#39;ai_leader_alive&#39;: 1, &#39;is_mini_success&#39;: -1}
</span></code></pre></div></p>
<p>In the log, We can see that each step displays some fields from the above definitions as <code>Definition of Mini-game messages</code>, and some are auxiliary fields designed by mini-game itself such as <code>human_leader_alive</code>.</p>
<h2 id="create-new-mini-game">Create new Mini-Game</h2>
<p>The general pipeline of creating new mini-game is as follows:</p>
<div align=center>
<pre class="mermaid"><code>graph TD
    A(Be clear about \nwhat to do) --&gt; D(Use gtk tool to generate basic archive)
    D --&gt; F(Set mini-game messages by lua script)
    F --&gt; E(&lt;b&gt;Large batch auto random generation&lt;/b&gt;)
    E --&gt; H{Mini-Game Validation}
    H --&gt; |Not Pass| J{Bug from \nCivrealm}
    J --&gt; |Yes| K[Contribute bugfix for Civrealm]
    J --&gt; |No| D
    H --&gt; |Pass| I[Create new Mini-Game successfully]</code></pre>
</div>

<h3 id="be-clear-about-what-to-do"><b><i>Be clear about what to do</i></b></h3>
<p>The basic design mechanisms of mini-game are:</p>
<ul>
<li>
<p><b>Single Goal.</b> Don't consider multiple learning objectives at the same time, otherwise the game will become less mini after more influences are introduced.</p>
</li>
<li>
<p><b>Feasible Action.</b> In the huge space of action, be clear about which actions are relevant to your goal, and avoid too many unrelated or paradoxical actions in actionable actions.</p>
</li>
<li>
<p><b>Computable Reward.</b> In addition to the final score at the end of the game, the reward for each step or turn can be defined and calculated.</p>
</li>
</ul>
<p>At the beginning of designing a mini-game, you have to answer the following questions:</p>
<ul>
<li>
<p>What type of the mini-game do you want to design?</p>
</li>
<li>
<p>When does the mini-game end?</p>
</li>
<li>
<p>How to calculate the reward for each step?</p>
</li>
<li>
<p>How to set the difficulty of the game? </p>
</li>
</ul>
<p>These questions will be given appropriate suggestions to some extent below.</p>
<h3 id="use-gtk-tool-to-generate-basic-archive"><b><i>Use gtk tool to generate basic archive</i></b></h3>
<h3 id="set-mini-game-messages-by-lua-script"><b><i>Set mini-game messages by lua script</i></b></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><b>Donot modify sav file directly in general.</b> Because the fields in the sav file have dependencies on each other, if you modify a field without noticing some other fields that need to be modified at the same time, it will cause the server to load the sav file unsuccessfully.</p>
</div>
<p>The lua script is used to send mini-game messages to the agent. Before adding the lua script for basic sav file, you need to understand the archive format of freeciv and how it defines the game state internally.</p>
<ul>
<li>
<p>The suffix of the game archive file is <code>.sav</code>, and usually compressed as a compressed file with <code>.xz</code> or <code>.zst</code> suffix. If the archive file is compressed, you need to use the corresponding component to decompress it to get the sav file.</p>
</li>
<li>
<p>In the sav file, there are many key-value structures to describe the current game state. Here, We list the main tags and their explanations:</p>
</li>
</ul>
<table>
    <tr> 
        <td bgcolor="Lavender"><b>Tag</b></td>
        <td bgcolor="Lavender"><b>Description</b></td>
    </tr>
    <tr> 
        <td>savefile</td>
        <td>A set of definition rules for common elements, including activity, technology, etc.</td>
    </tr>
    <tr> 
        <td>game</td>
        <td>The base state values of the game, such as turn, launch order and year.</td>
    </tr>
    <tr> 
        <td>script</td>
        <td>The script of lua. At the inherent or designed trigger points of the game, obtain the internal data of the game, calculate the custom game state values, and send out event messages.</td>
    </tr>
    <tr> 
        <td>settings</td>
        <td>The setting of freeciv server.</td>
    </tr>
    <tr> 
        <td>map</td>
        <td>The global map of world, and distribution information of resources, cities, and land development.</td>
    </tr>
    <tr>
        <td>player0</td>
        <td>The game status of a player with an id of 0, including information such as how many units and cities the player0 have. </td>
    </tr>
    <tr> 
        <td>score0</td>
        <td>The scores of a player with an id of 0, including information such as total score and unhappy degree.</td>
    </tr>
    <tr>
        <td>research</td>
        <td>The progress of research for each player. </td>
    </tr>
</table>

<p>Here, we focus on the implementation of <code>script</code> tag. In the sav file, the format of <code>script</code> as below:
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>[script]
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>code=${lua code}$
</span></code></pre></div>
<code>{lua code}</code> is the code of lua language that implements to send mini-game messages.</p>
<p><b>Firstly</b>, you need to consider which trigger points to set during the game in order to change the status value of the mini-game, and set up the end conditions of the game.
All trigger action functions can be referred to the <a href="https://freeciv.fandom.com/wiki/Lua_reference_manual#Legend">Lua Reference manual</a>. We list the common trigger action functions as follows:</p>
<table>
    <tr> 
        <td bgcolor="Lavender"><b>(return) type</b></td>
        <td bgcolor="Lavender"><b>function name/variable</b></td>
        <td bgcolor="Lavender"><b>arguments</b></td>
        <td bgcolor="Lavender"><b>comments</b></td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>turn_begin</td>
        <td>(Number turn, Number year)</td>
        <td>Trigger at each turn begining.</td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>city_built</td>
        <td>(City city)</td>
        <td>Trigger at city built.</td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>unit_lost</td>
        <td>(Unit unit, Player loser, String reason)</td>
        <td>Trigger at unit lost.</td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>city_destroyed</td>
        <td>(City city, Player loser, Player destroyer)</td>
        <td>Trigger at city destroyed.</td>
    </tr>
</table>

<p>In addition, we developed the following trigger action function to enhance the perception of the freeciv-server game process:</p>
<table>
    <tr> 
        <td bgcolor="Lavender"><b>(return) type</b></td>
        <td bgcolor="Lavender"><b>function name/variable</b></td>
        <td bgcolor="Lavender"><b>arguments</b></td>
        <td bgcolor="Lavender"><b>comments</b></td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>game_started</td>
        <td>(Player player)</td>
        <td>Trigger at game started. The `game_started` supports to display the welcome message at the beginning of the game, if you use the `turn_begin` to set turn=1 to display the welcome message, it will not take effect, because the game thinks that it is already in the current turn running state, and will not trigger the judgment of the `turn_begin`, although this function can be achieved by setting the technique of phase=1 additionally, but the setting will cause other players to act first, which will bring unexpected problems.</td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>game_ended</td>
        <td>(Player player)</td>
        <td>Trigger at game ended. Since freeciv-server has many internal conditions for ending the game, all the end states of the game can be recycled by using game_ended. If game ended, set mini-game `status`=1(MinitaskGameStatus.MGS_END_GAME).</td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>action_finished_worker_build</td>
        <td>(City city)</td>
        <td>Trigger at activity finished by worker.</td>
    </tr>
    <tr> 
        <td>Boolean</td>
        <td>action_started_worker_build</td>
        <td>(City city)</td>
        <td>Trigger at activity started by worker.</td>
    </tr>
</table>

<p><b>Secondly</b>, calculate the mini-score and mini-goal. </p>
<p>Taking mini-game <code>battle</code> as an example, the formula for calculating the <code>mini-score</code> is as follows:</p>
<p><span class="arithmatex">\(\text{mini_score}=\text{unit_cnt_of_human_player} - \text{unit_cnt_of_ai_player}\)</span></p>
<p>The larger the mini_score is, the more units of human player survives, the better, and the more units of ai player is destroyed, the better. The <code>mini-goal</code> is setting to</p>
<p><span class="arithmatex">\(\text{mini_goal}=\text{unit_cnt_of_human_player}\)</span></p>
<p>It means that if you want to satisfy mini_score&gt;=mini_goal to succeed, you need to destroy all units of ai player.</p>
<p><b>Finally</b>, wrap your message of mini-game and send it out throught E.SCRIPT event. The event function is:
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>notify.event(nil, nil, E.SCRIPT, _(${message}))
</span></code></pre></div></p>
<h3 id="large-batch-auto-random-generation"><b><i>Large batch auto random generation</i></b></h3>
<p>The auto random generation is supported by the <code>freeciv-sav</code> module. To implement a new mini-game dependently, you should inherit class <code>SavTaskGenerator</code>. For example,</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span> <span class="nn">freeciv_sav.tasks.sav_task</span> <span class="kn">import</span> <span class="n">SavTaskGenerator</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="k">class</span> <span class="nc">NewMiniGameGenerator</span><span class="p">(</span><span class="n">SavTaskGenerator</span><span class="p">):</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="k">def</span> <span class="nf">create_new_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lua_conf</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="sd">        Create new game.</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="sd">        Parameters</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="sd">        ----------</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="sd">        lua_conf : str</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="sd">            The lua script designed.</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>            <span class="p">{</span><span class="n">Call</span> <span class="n">the</span> <span class="n">functions</span> <span class="kn">from</span> <span class="nn">tools</span> <span class="n">to</span> <span class="n">implement</span> <span class="n">randomization</span><span class="p">}</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>            <span class="k">break</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>        <span class="k">return</span>
</span></code></pre></div>
<p>The tools contains <code>map_op</code> <code>unit_op</code>, <code>player_op</code>, <code>game_op</code>, etc. The main functions of tools are as follows:</p>
<table>
    <tr> 
        <td bgcolor="Lavender"><b>OP</b></td>
        <td bgcolor="Lavender"><b>function name</b></td>
        <td bgcolor="Lavender"><b>comments</b></td>
    </tr>
    <tr>
        <td>map_op</td>
        <td>gen_random_walk_map</td>
        <td>Randomly generate mini-game map by random walk with modifying the terrain, resource and shape of land.</td>
    </tr>
    <tr>
        <td>unit_op</td>
        <td>set_location_with_cluster</td>
        <td>Randomly set location for units.</td>
    </tr>
    <tr>
        <td>player_op</td>
        <td>set_name</td>
        <td>Assignment the name of mini-game.</td>
    </tr>
    <tr>
        <td>game_op</td>
        <td>set_init_status</td>
        <td>Set game status initially.</td>
    </tr>
</table>

<p>Use these functions to help you to implement large batch auto random generation of mini-game. </p>
<h3 id="mini-game-validation"><b><i>Mini-Game Validation</i></b></h3>
<p>Check your mini-game inside <code>freeciv-web</code>, and test the mini-game to follow the section <code>Play mini-game as a random agent</code>. If the tests pass, congratulations on completing the task for creating new mini-game.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.indexes", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>